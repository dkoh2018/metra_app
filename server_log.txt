
> metra-schedule-tracker@1.0.0 start
> NODE_ENV=production node dist/index.js

[dotenv@17.2.3] injecting env (2) from .env -- tip: âš™ï¸  override existing env vars with { override: true }
Found 1966 trips (UP-NW + MD-W + UP-N + BNSF)
Found 35482 stop times for all supported lines
Inserted 3932 schedule records
GTFS data loaded successfully!
â° [SCHEDULE] Next daily scrape scheduled for 12/19/2025, 3:30:00 AM (in 2 hours)
ðŸ“… GTFS: Data is just updated, no update needed
âœ… Database initialized successfully
â±ï¸  Starting real-time data polling...
ðŸŒ¦ï¸  Starting weather data polling (dynamic interval)...
ðŸŒ¦ï¸  Next weather update in 30 min (active=false)
âš ï¸  Port 3001 is in use (PID: 39422), attempting to free it (attempt 1/3)...
âœ… Port 3001 freed
Real-time data updated successfully
âœ… Weather data updated for 3 locations
âœ… Backend server running on http://localhost:3001/
ðŸ“¡ API endpoints available at http://localhost:3001/api/*
â±ï¸  Server polling aligned to wall clock (:00/:30)
Real-time data updated successfully
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[API] [1766127725604-kyxwx4pk1] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127725604-kyxwx4pk1] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
[CACHE MISS] No fresh cache (< 5 min) for PALATINE->OTC, checking stale cache or scraping...
[CACHE] No stale cache available for PALATINE->OTC
[API] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[API] [1766127725604-kyxwx4pk1] Waiting for scraping promise to complete for PALATINE->OTC...
âœ… Using Puppeteer's bundled Chrome at: /Users/davidoh/.cache/puppeteer/chrome/mac_arm-143.0.7499.42/chrome-mac-arm64/Google Chrome for Testing.app/Contents/MacOS/Google Chrome for Testing
[API] [1766127736668-vcica5n9z] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127736668-vcica5n9z] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
Scraping already in progress for PALATINE->OTC, waiting...
[API] Saved/Updated 0 entries for PALATINE->OTC
[API] [1766127725604-kyxwx4pk1] Scraping completed for PALATINE->OTC, result has 0 entries
[API] [1766127725604-kyxwx4pk1] Sending JSON response for PALATINE->OTC...
[API] [1766127725604-kyxwx4pk1] Sending response after 12095ms (0 entries)
[API] [1766127725604-kyxwx4pk1] Request completed in 12095ms
[API] [1766127736668-vcica5n9z] Request completed in 1031ms
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[API] [1766127740888-e8bpx0w02] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127740888-e8bpx0w02] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
[CACHE MISS] No fresh cache (< 5 min) for PALATINE->OTC, checking stale cache or scraping...
[CACHE] No stale cache available for PALATINE->OTC
[API] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[API] [1766127740888-e8bpx0w02] Waiting for scraping promise to complete for PALATINE->OTC...
Real-time data updated successfully
[API] Saved/Updated 0 entries for PALATINE->OTC
[API] [1766127740888-e8bpx0w02] Scraping completed for PALATINE->OTC, result has 0 entries
[API] [1766127740888-e8bpx0w02] Sending JSON response for PALATINE->OTC...
[API] [1766127740888-e8bpx0w02] Sending response after 11681ms (0 entries)
[API] [1766127740888-e8bpx0w02] Request completed in 11681ms
[API] [1766127778667-wc5rk5583] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127778667-wc5rk5583] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
[CACHE MISS] No fresh cache (< 5 min) for PALATINE->OTC, checking stale cache or scraping...
[CACHE] No stale cache available for PALATINE->OTC
[API] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[API] [1766127778667-wc5rk5583] Waiting for scraping promise to complete for PALATINE->OTC...
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[API] Saved/Updated 0 entries for PALATINE->OTC
[API] [1766127778667-wc5rk5583] Scraping completed for PALATINE->OTC, result has 0 entries
[API] [1766127778667-wc5rk5583] Sending JSON response for PALATINE->OTC...
[API] [1766127778667-wc5rk5583] Sending response after 11749ms (0 entries)
[API] [1766127778667-wc5rk5583] Request completed in 11749ms
[API] [1766127796662-rlfz75tn8] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127796662-rlfz75tn8] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
[CACHE MISS] No fresh cache (< 5 min) for PALATINE->OTC, checking stale cache or scraping...
[CACHE] No stale cache available for PALATINE->OTC
[API] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[API] [1766127796662-rlfz75tn8] Waiting for scraping promise to complete for PALATINE->OTC...
[API] [1766127800943-mo4cuj2i5] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127800943-mo4cuj2i5] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
Scraping already in progress for PALATINE->OTC, waiting...
[API] Saved/Updated 0 entries for PALATINE->OTC
[API] [1766127796662-rlfz75tn8] Scraping completed for PALATINE->OTC, result has 0 entries
[API] [1766127796662-rlfz75tn8] Sending JSON response for PALATINE->OTC...
[API] [1766127796662-rlfz75tn8] Sending response after 11700ms (0 entries)
[API] [1766127796662-rlfz75tn8] Request completed in 11701ms
[API] [1766127800943-mo4cuj2i5] Request completed in 7420ms
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
[API] [1766127856663-ywaao6kf0] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127856663-ywaao6kf0] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
[CACHE MISS] No fresh cache (< 5 min) for PALATINE->OTC, checking stale cache or scraping...
[CACHE] No stale cache available for PALATINE->OTC
[API] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[API] [1766127856663-ywaao6kf0] Waiting for scraping promise to complete for PALATINE->OTC...
[API] [1766127860987-j36au51hf] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127860987-j36au51hf] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
Scraping already in progress for PALATINE->OTC, waiting...
[API] Saved/Updated 0 entries for PALATINE->OTC
[API] [1766127856663-ywaao6kf0] Scraping completed for PALATINE->OTC, result has 0 entries
[API] [1766127856663-ywaao6kf0] Sending JSON response for PALATINE->OTC...
[API] [1766127856663-ywaao6kf0] Sending response after 11429ms (0 entries)
[API] [1766127856663-ywaao6kf0] Request completed in 11429ms
[API] [1766127860987-j36au51hf] Request completed in 7105ms
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 6 trains across all lines
[POSITIONS] Bulk cached 6 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 7 trains across all lines
[POSITIONS] Bulk cached 7 trains across all lines
[POSITIONS] Bulk cached 7 trains across all lines
[POSITIONS] Bulk cached 7 trains across all lines
[API] [1766127916669-sqd1aotp4] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127916669-sqd1aotp4] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
[CACHE MISS] No fresh cache (< 5 min) for PALATINE->OTC, checking stale cache or scraping...
[CACHE] No stale cache available for PALATINE->OTC
[API] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[API] [1766127916669-sqd1aotp4] Waiting for scraping promise to complete for PALATINE->OTC...
[API] [1766127920988-vw5pmm8ki] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127920988-vw5pmm8ki] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
Scraping already in progress for PALATINE->OTC, waiting...
[API] Saved/Updated 0 entries for PALATINE->OTC
[API] [1766127916669-sqd1aotp4] Scraping completed for PALATINE->OTC, result has 0 entries
[API] [1766127916669-sqd1aotp4] Sending JSON response for PALATINE->OTC...
[API] [1766127916669-sqd1aotp4] Sending response after 11442ms (0 entries)
[API] [1766127916669-sqd1aotp4] Request completed in 11443ms
[API] [1766127920988-vw5pmm8ki] Request completed in 7124ms
[POSITIONS] Bulk cached 7 trains across all lines
[POSITIONS] Bulk cached 7 trains across all lines
[POSITIONS] Bulk cached 7 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 7 trains across all lines
Real-time data updated successfully
[API] [1766127980991-6tv47kns7] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766127980991-6tv47kns7] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
[CACHE MISS] No fresh cache (< 5 min) for PALATINE->OTC, checking stale cache or scraping...
[CACHE] No stale cache available for PALATINE->OTC
[API] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[API] [1766127980991-6tv47kns7] Waiting for scraping promise to complete for PALATINE->OTC...
[API] Scraping failed: Attempted to use detached Frame 'F1F74D40CBBA06CAC2DA579FC3D1A946'.
[API ERROR] [1766127980991-6tv47kns7] Scraping failed after 7848ms for PALATINE->OTC: Attempted to use detached Frame 'F1F74D40CBBA06CAC2DA579FC3D1A946'.
[API ERROR] [1766127980991-6tv47kns7] Stack: Error: Attempted to use detached Frame 'F1F74D40CBBA06CAC2DA579FC3D1A946'.
    at CdpFrame.<anonymous> (file:///Users/davidoh/2025/depaul/CREDICO/metra-schedule-tracker/node_modules/.pnpm/puppeteer-core@24.33.0/node_modules/puppeteer-core/lib/esm/puppeteer/util/decorators.js:99:23)
    at CdpPage.evaluate (file:///Users/davidoh/2025/depaul/CREDICO/metra-schedule-tracker/node_modules/.pnpm/puppeteer-core@24.33.0/node_modules/puppeteer-core/lib/esm/puppeteer/api/Page.js:814:43)
    at file:///Users/davidoh/2025/depaul/CREDICO/metra-schedule-tracker/dist/index.js:1035:40
    at async scrapeAndCacheCrowding (file:///Users/davidoh/2025/depaul/CREDICO/metra-schedule-tracker/dist/index.js:1137:20)
    at async file:///Users/davidoh/2025/depaul/CREDICO/metra-schedule-tracker/dist/index.js:1684:26
Scraping interrupted for PALATINE->OTC (browser detached - likely server restart)
[CROWDING] No data available for PALATINE->OTC (scraping failed, no stale cache)
[API] [1766127980991-6tv47kns7] Sending response after 7848ms (0 entries)
[API] [1766127980991-6tv47kns7] Request completed in 7849ms
