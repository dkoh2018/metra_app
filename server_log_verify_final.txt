
> metra-schedule-tracker@1.0.0 start
> NODE_ENV=production node dist/index.js

[dotenv@17.2.3] injecting env (2) from .env -- tip: ðŸ” encrypt with Dotenvx: https://dotenvx.com
Found 1966 trips (UP-NW + MD-W + UP-N + BNSF)
Found 35482 stop times for all supported lines
Inserted 3932 schedule records
GTFS data loaded successfully!
â° [SCHEDULE] Startup check: Found 0 valid crowding entries in database.
â„ï¸ [SCHEDULE] Cold start detected (low data). Triggering immediate initial seed...
â° [SCHEDULE] Starting daily crowding seed (3:30 AM)...
â° [SCHEDULE] Adding priority route: PALATINE->OTC
â° [SCHEDULE] Adding priority route: OTC->PALATINE
â° [SCHEDULE] Adding priority route: SCHAUM->CUS
â° [SCHEDULE] Adding priority route: CUS->SCHAUM
â° [SCHEDULE] Adding priority route: WILMETTE->OTC
â° [SCHEDULE] Adding priority route: OTC->WILMETTE
â° [SCHEDULE] Adding priority route: WESTMONT->CUS
â° [SCHEDULE] Adding priority route: CUS->WESTMONT
â° [SCHEDULE] Found 8 routes to seed: PALATINE->OTC, OTC->PALATINE, SCHAUM->CUS, CUS->SCHAUM, WILMETTE->OTC, OTC->WILMETTE, WESTMONT->CUS, CUS->WESTMONT
â° [SCHEDULE] Processing 8 routes with concurrency 3...
[SCHEDULED] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[SCHEDULED] Starting scraping for PALATINE->OTC (Line: UP-NW)...
[SCHEDULED] Starting scraping for OTC->PALATINE (Line: UP-NW)...
[SCHEDULED] Starting scraping for OTC->PALATINE (Line: UP-NW)...
[SCHEDULED] Starting scraping for SCHAUM->CUS (Line: MD-W)...
[SCHEDULED] Starting scraping for SCHAUM->CUS (Line: MD-W)...
â° [SCHEDULE] Next daily scrape scheduled for 12/19/2025, 3:30:00 AM (in 2 hours)
ðŸ“… GTFS: Data is just updated, no update needed
âœ… Database initialized successfully
â±ï¸  Starting real-time data polling...
ðŸŒ¦ï¸  Starting weather data polling (dynamic interval)...
ðŸŒ¦ï¸  Next weather update in 30 min (active=false)
âœ… Using Puppeteer's bundled Chrome at: /Users/davidoh/.cache/puppeteer/chrome/mac_arm-143.0.7499.42/chrome-mac-arm64/Google Chrome for Testing.app/Contents/MacOS/Google Chrome for Testing
[SCHEDULED] Using overridden schedule date: 12/20/2025, 4:00:00 AM (1766224800)
[SCHEDULED] Using overridden schedule date: 12/20/2025, 4:00:00 AM (1766224800)
[SCHEDULED] Using overridden schedule date: 12/20/2025, 4:00:00 AM (1766224800)
[SCHEDULED] Constructed URL: https://www.metra.com/schedules?line=UP-NW&orig=PALATINE&dest=OTC&time=1766224800&allstops=0&redirect=1766130736
[SCHEDULED] Constructed URL: https://www.metra.com/schedules?line=UP-NW&orig=OTC&dest=PALATINE&time=1766224800&allstops=0&redirect=1766130736
[SCHEDULED] Constructed URL: https://www.metra.com/schedules?line=MD-W&orig=SCHAUM&dest=CUS&time=1766224800&allstops=0&redirect=1766130736
Real-time data updated successfully
âœ… Backend server running on http://localhost:3001/
ðŸ“¡ API endpoints available at http://localhost:3001/api/*
âœ… Weather data updated for 5 locations
[API] [1766130741550-1pug797dv] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766130741550-1pug797dv] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[CACHE MISS] No fresh cache for PALATINE->OTC (checking for stale cache or scraping...)
Scraping already in progress for PALATINE->OTC, waiting...
[SCHEDULED] Saved/Updated 12 entries for SCHAUM->CUS
[SCHEDULED] Saved/Updated 16 entries for PALATINE->OTC
[SCHEDULED] Completed scraping for SCHAUM->CUS
[SCHEDULED] Saved/Updated 17 entries for OTC->PALATINE
[API] [1766130741550-1pug797dv] Request completed in 2645ms
[SCHEDULED] Completed scraping for PALATINE->OTC
[SCHEDULED] Completed scraping for OTC->PALATINE
[SCHEDULED] Starting scraping for CUS->SCHAUM (Line: MD-W)...
[SCHEDULED] Starting scraping for CUS->SCHAUM (Line: MD-W)...
[SCHEDULED] Starting scraping for WILMETTE->OTC (Line: UP-N)...
[SCHEDULED] Starting scraping for WILMETTE->OTC (Line: UP-N)...
[SCHEDULED] Starting scraping for OTC->WILMETTE (Line: UP-N)...
[SCHEDULED] Starting scraping for OTC->WILMETTE (Line: UP-N)...
[SCHEDULED] Using overridden schedule date: 12/20/2025, 4:00:00 AM (1766224800)
[SCHEDULED] Using overridden schedule date: 12/20/2025, 4:00:00 AM (1766224800)
[SCHEDULED] Using overridden schedule date: 12/20/2025, 4:00:00 AM (1766224800)
[SCHEDULED] Constructed URL: https://www.metra.com/schedules?line=MD-W&orig=CUS&dest=SCHAUM&time=1766224800&allstops=0&redirect=1766130744
[SCHEDULED] Constructed URL: https://www.metra.com/schedules?line=UP-N&orig=WILMETTE&dest=OTC&time=1766224800&allstops=0&redirect=1766130744
[SCHEDULED] Constructed URL: https://www.metra.com/schedules?line=UP-N&orig=OTC&dest=WILMETTE&time=1766224800&allstops=0&redirect=1766130744
â±ï¸  Server polling aligned to wall clock (:00/:30)
Real-time data updated successfully
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
[SCHEDULED] Saved/Updated 12 entries for CUS->SCHAUM
[SCHEDULED] Saved/Updated 15 entries for OTC->WILMETTE
[SCHEDULED] Saved/Updated 15 entries for WILMETTE->OTC
[SCHEDULED] Completed scraping for CUS->SCHAUM
[SCHEDULED] Completed scraping for OTC->WILMETTE
[SCHEDULED] Completed scraping for WILMETTE->OTC
[SCHEDULED] Starting scraping for WESTMONT->CUS (Line: BNSF)...
[SCHEDULED] Starting scraping for WESTMONT->CUS (Line: BNSF)...
[SCHEDULED] Starting scraping for CUS->WESTMONT (Line: BNSF)...
[SCHEDULED] Starting scraping for CUS->WESTMONT (Line: BNSF)...
[SCHEDULED] Using overridden schedule date: 12/20/2025, 4:00:00 AM (1766224800)
[SCHEDULED] Using overridden schedule date: 12/20/2025, 4:00:00 AM (1766224800)
[SCHEDULED] Constructed URL: https://www.metra.com/schedules?line=BNSF&orig=WESTMONT&dest=CUS&time=1766224800&allstops=0&redirect=1766130752
[SCHEDULED] Constructed URL: https://www.metra.com/schedules?line=BNSF&orig=CUS&dest=WESTMONT&time=1766224800&allstops=0&redirect=1766130752
[API] [1766130756178-flpwk5pz0] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766130756178-flpwk5pz0] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[DEBUG] First cached item: {"trip_id":"UP-NW_UNW700_V2_A","crowding":"low","scheduled_departure":null,"predicted_departure":null,"scheduled_arrival":null,"predicted_arrival":null,"updated_at":"2025-12-19 07:52:24"}
[CACHE HIT] Returning cached crowding data for PALATINE->OTC (16 trains, -360 min old)
[API] [1766130756178-flpwk5pz0] Request completed in 1ms
[SCHEDULED] Saved/Updated 18 entries for WESTMONT->CUS
[SCHEDULED] Saved/Updated 18 entries for CUS->WESTMONT
[SCHEDULED] Completed scraping for WESTMONT->CUS
[SCHEDULED] Completed scraping for CUS->WESTMONT
â° [SCHEDULE] Daily seed completed!
[API] [1766130778138-3c2jswb8q] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766130778138-3c2jswb8q] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[DEBUG] First cached item: {"trip_id":"UP-NW_UNW700_V2_A","crowding":"low","scheduled_departure":null,"predicted_departure":null,"scheduled_arrival":null,"predicted_arrival":null,"updated_at":"2025-12-19 07:52:24"}
[CACHE HIT] Returning cached crowding data for PALATINE->OTC (16 trains, -359 min old)
[API] [1766130778138-3c2jswb8q] Request completed in 2ms
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 3 trains across all lines
[API] [1766130789304-89haad5yx] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766130789304-89haad5yx] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[DEBUG] First cached item: {"trip_id":"UP-NW_UNW700_V2_A","crowding":"low","scheduled_departure":null,"predicted_departure":null,"scheduled_arrival":null,"predicted_arrival":null,"updated_at":"2025-12-19 07:52:24"}
[CACHE HIT] Returning cached crowding data for PALATINE->OTC (16 trains, -359 min old)
[API] [1766130789304-89haad5yx] Request completed in 1ms
[API] [1766130800852-0lzk67bb4] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766130800852-0lzk67bb4] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[DEBUG] First cached item: {"trip_id":"UP-NW_UNW700_V2_A","crowding":"low","scheduled_departure":null,"predicted_departure":null,"scheduled_arrival":null,"predicted_arrival":null,"updated_at":"2025-12-19 07:52:24"}
[CACHE HIT] Returning cached crowding data for PALATINE->OTC (16 trains, -359 min old)
[API] [1766130800852-0lzk67bb4] Request completed in 0ms
Real-time data updated successfully
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
[API] [1766130815811-f6gs92igo] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766130815811-f6gs92igo] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[DEBUG] First cached item: {"trip_id":"UP-NW_UNW700_V2_A","crowding":"low","scheduled_departure":null,"predicted_departure":null,"scheduled_arrival":null,"predicted_arrival":null,"updated_at":"2025-12-19 07:52:24"}
[CACHE HIT] Returning cached crowding data for PALATINE->OTC (16 trains, -359 min old)
[API] [1766130815811-f6gs92igo] Request completed in 0ms
[API] [1766130829082-f3nb2gx5y] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766130829082-f3nb2gx5y] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[DEBUG] First cached item: {"trip_id":"UP-NW_UNW700_V2_A","crowding":"low","scheduled_departure":null,"predicted_departure":null,"scheduled_arrival":null,"predicted_arrival":null,"updated_at":"2025-12-19 07:52:24"}
[CACHE HIT] Returning cached crowding data for PALATINE->OTC (16 trains, -359 min old)
[API] [1766130829082-f3nb2gx5y] Request completed in 1ms
[API] [1766130838122-ng6govqf6] Crowding request: PALATINE->OTC (force=undefined)
[API] [1766130838122-ng6govqf6] Railway env check - NODE_ENV: production, PORT: undefined
[DB] Schema check passed: 'predicted_departure' column exists.
[DEBUG] First cached item: {"trip_id":"UP-NW_UNW700_V2_A","crowding":"low","scheduled_departure":null,"predicted_departure":null,"scheduled_arrival":null,"predicted_arrival":null,"updated_at":"2025-12-19 07:52:24"}
[CACHE HIT] Returning cached crowding data for PALATINE->OTC (16 trains, -358 min old)
[API] [1766130838122-ng6govqf6] Request completed in 1ms
[POSITIONS] Bulk cached 3 trains across all lines
Real-time data updated successfully
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
[POSITIONS] Bulk cached 3 trains across all lines
